<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <load href="__PUBLIC__/Home/js/jquery-1.8.2.min.js" />
   <load href="__PUBLIC__/Home/js/jquery-2.1.3.min.js" /> 
    <load href="__PUBLIC__/Home/js/menu.js" />
    <load href="__PUBLIC__/Home/js/select.js" />
    <load href="__PUBLIC__/Home/css/style.css" />
    <load href="__PUBLIC__/Home/alert/js/sweet-alert.js" />
    <load href="__PUBLIC__/Home/alert/css/sweet-alert.css" />
    <link rel="icon" type="image/png" href="__PUBLIC__/home/images/haixiu.png"> 

        
  
<title>馋猫</title>

</head>
<body>  

    <!--Begin Header Begin-->
    <include file="./Public/Home/PC_top.html"/>
    <!--End Header End--> 
<div class="i_bg bg_color">
    <!--Begin 用户中心 Begin -->
	<div class="m_content">
   <!-- 左边菜单 start -->
    <div class="m_left">
            <div class="left_n">个人中心</div>
                <div class="left_m">
                <div class="left_m_t t_bg2">会员中心</div>
                <ul>
                    <li><a href="{:U('Home/Clientuser/index')}">我的资料</a></li>
                    <li><a href="{:U('Home/Enshrine/index')}">我的收藏</a></li>
                      <li><a href="{:U('Home/Link/index')}">浏览记录</a></li>
                    <li><a href="{:U('Home/Message/index')}">我的留言</a></li>
                    <li><a href="{:U('Home/Clientuser/safe')}">账户安全</a></li>
                    <li><a href="{:U('Home/Clientuser/usermessage')}">完善资料</a></li>
                </ul>
            </div>
            <div class="left_m">
                <div class="left_m_t t_bg1">订单中心</div>
                <ul>
                     <li><a href="{:U('Home/Orderform/index')}">我的订单</a></li>
                        <li><a href="#">我的评论</a></li>
                    <li><a href="{:U('Home/Address/index')}">收货地址</a></li>
                    <li><a href="#">缺货登记</a></li>
                    <li><a href="#">跟踪订单</a></li>
                </ul>
            </div> 
        </div>
    <!-- 左边菜单 end -->
	<div class="m_right">
            <p></p>
            <div class="mem_tit">账户安全</div>
            
            <div class="m_des">
                <form action="{:U('Home/Clientuser/safe')}" method='post' id='xiugai'>
                <table border="0" style="width:880px;"  cellspacing="0" cellpadding="0">
                  <tr height="45">
                    <td width="80" align="right">原手机 &nbsp; &nbsp;</td>
                    <td><input type="text" disabled placeholder="{$Think.session.homeuser.clt_phone}" class="add_ipt" style="width:180px;" />&nbsp; <font color="#ff4e00">*</font></td>
                  </tr>
                  <tr height="45">
                    <td align="right">新手机 &nbsp; &nbsp;</td>
                    <td><input id="newphone" type="text" name="clt_phone" class="add_ipt" style="width:180px;" /><span id="nophone"></span>&nbsp; <font color="#ff4e00">*</font></td>
                  </tr>
                  <tr height="50">
                    <td>&nbsp;</td>
                    <td><input type="submit" value="确认修改" id="zuzhi" class="btn_tj" /></td>
                  </tr>
                </table>
                </form>
            </div>
            <div class="m_des">
                <form action="{:U('Home/Clientuser/orginPass')}" method='post' id='xiupass' id="FormPass">
                <input type="hidden" name="clt_id" value="{$Think.session.homeuser.clt_id}">
                <table border="0" style="width:880px;"  cellspacing="0" cellpadding="0">
                  <tr height="45">
                    <td width="80" align="right">原密码 &nbsp; &nbsp;</td>
                    <td><input type="password" required id="ypass" Clt="{$Think.session.homeuser.clt_id}" name="pass" class="add_ipt" style="width:180px;" ere/>&nbsp; <font color="#ff4e00"><span id="yspan"></span></font></td>
                  </tr>
                  <tr height="45">
                    <td align="right">新密码 &nbsp; &nbsp;</td>
                    <td><input type="password" id="newpass" required name="clt_pass" class="add_ipt" style="width:180px;" />&nbsp; <font color="#ff4e00"><span id="nspan"></span></font></td>
                  </tr>
                  <tr height="45">
                    <td align="right">确认密码 &nbsp; &nbsp;</td>
                    <td><input type="password" name="repass" id="repwd" required class="add_ipt" style="width:180px;" />&nbsp; <font color="#ff4e00"><span id="respan"></span></font></td>
                  </tr>
                  <tr height="50">
                    <td>&nbsp;</td>
                    <td id="disable"><input type="submit" value="确认修改" class="btn_tj" id='poiu' disabled /></td>
                  </tr>
                </table>
                </form>
            </div>
  
        </div>
    </div>
  
      <!--End 用户中心 End--> 
     <script type="text/javascript">
            var xiugai = document.getElementById('xiugai');
            var nophone = document.getElementById('nophone');
            var eew = document.getElementById('newphone');

            eew.onblur = function(){
                eeew = this.value;

                var phoneReg = /^1[34578]\d{9}$/;
                if(!phoneReg.test(eeew)){

                    nophone.innerHTML = "<font style='color:red;'>手机格式错误!</font>";

                    xiugai.onsubmit = function(){
                        return false;
                    }

                }else{
                        nophone.innerHTML = '';

                        xiugai.onsubmit = function(){
                            return true;
                        }
                }

            } 
           $('#ypass').blur(function(){
                    if($(this).val() == '') {
                        $('#yspan').html('原密码不能为空!');
                    }else{
                        var cclt = $(this).attr('Clt');
                        console.log(cclt);
                        var p = $(this).val();
                        // console.log(p);
                        $.post("{:U('Home/Clientuser/savePass')}",{'clt_pass':p,'clt_id':cclt},function(data){
                                    if(data != '1'){

                                            $('#yspan').html('原密码不正确!');
                                            $('#ypass').val('');

                                       }
                                       //验证新密码
                                       // else if(!patrn.exec($(this).val() )){
                                       //      $('#yspan').html('密码格式不正确!');
                                       // }
                                // else{
                                //     $('#yspan').append('<img src="__PUBLIC__/Home/images/ok.png" width="14" height="14" />');
                                // }
                        });
                    }
                    
           });
             $('#ypass').focusin(function(){
                         $('#yspan').html('');
             });
             // //验证新密码与原密码是否一致
              var patrn=/^[a-zA-Z]\w{5,21}$/;
             $('#newpass').blur(function(){
                    
                    if($(this).val() == ''){

                        $('#nspan').html('新密码不能为空!');

                    }else if(!patrn.exec($(this).val() )){
                       
                        $('#nspan').html('请输入6-20个以字母开头、可带数字、“_”的密码!');
                    }          
             });
              $('#newpass').focusin(function(){
                    $('#nspan').html('');
             });
              //验证两字输入的密码是否一样
              $('#repwd').blur(function(){
                    if($(this).val() != $('#newpass').val() ){
                        $('#respan').html('两次输入的密码不一致!');
                    }
              });
              $('#repwd').focusin(function(){
                    $('#respan').html('');
             });
              $('#disable').mouseover(function(){
                    if($('#ypass').val() !='' && $('#newpass').val() == $('#repwd').val()){
                         $('#poiu').removeAttr('disabled');
                  }
              });
              if($('#newpass').val() == $('#repwd').val()){
                    console.log(11);
              }

     </script>
    <!--Begin Footer Begin -->
    <include file="./Public/Home/PC_foot.html"/>

    <!--End Footer End -->   
   
